{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
  <h2>Change Owner Panel Passcode</h2>
  <p class="text-muted">
    This passcode is required to unlock the Owner / Superadmin panel.
    You must provide both your admin password and the current owner passcode.
  </p>

  <form method="post" action="{{ url_for('superadmin_change_passcode') }}">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

    <div class="mb-3">
      <label for="admin_password" class="form-label">Your Admin Password (re-authentication required)</label>
      <div style="position: relative;">
        <input type="password"
               id="admin_password"
               name="admin_password"
               class="form-control"
               required>
        <button type="button" class="toggle-password" data-target="admin_password" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; color: #6b7280;">Show</button>
      </div>
    </div>

    <div class="mb-3">
      <label for="current_passcode" class="form-label">Current Owner Passcode</label>
      <div style="position: relative;">
        <input type="password"
               id="current_passcode"
               name="current_passcode"
               class="form-control"
               required>
        <button type="button" class="toggle-password" data-target="current_passcode" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; color: #6b7280;">Show</button>
      </div>
    </div>

    <div class="mb-3">
      <label for="new_passcode" class="form-label">New Owner Passcode</label>
      <div style="position: relative;">
        <input type="password"
               id="new_passcode"
               name="new_passcode"
               class="form-control"
               required>
        <button type="button" class="toggle-password" data-target="new_passcode" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; color: #6b7280;">Show</button>
      </div>
      <small class="form-text text-muted">Must be at least 8 characters with at least one letter and one number.</small>
    </div>

    <div class="mb-3">
      <label for="confirm_passcode" class="form-label">Confirm New Owner Passcode</label>
      <div style="position: relative;">
        <input type="password"
               id="confirm_passcode"
               name="confirm_passcode"
               class="form-control"
               required>
        <button type="button" class="toggle-password" data-target="confirm_passcode" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; color: #6b7280;">Show</button>
      </div>
    </div>

    <button type="submit" class="btn btn-primary">
      Update Owner Passcode
    </button>
  </form>
</div>

<script>
  (function() {
    document.querySelectorAll('.toggle-password').forEach(function(btn) {
      btn.addEventListener('click', function() {
        const targetId = this.getAttribute('data-target');
        const input = document.getElementById(targetId);
        if (input.type === 'password') {
          input.type = 'text';
          this.textContent = 'Hide';
        } else {
          input.type = 'password';
          this.textContent = 'Show';
        }
      });
    });
  })();
</script>
{% endblock %}
