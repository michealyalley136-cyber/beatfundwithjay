{% extends "base.html" %}
{% block title %}Artist Dashboard · BeatFund{% endblock %}

{% block content %}
<div class="dashboard" data-role="artist">

  <!-- HERO -->
  <div class="dash-hero">
    <div class="dash-hero-card">
      <div class="dash-identity">
        {% set avatar_url = (current_user.avatar_url|default('', true)) %}
        {% if avatar_url %}
          <img class="avatar avatar-lg" src="{{ avatar_url }}" alt="Avatar">
        {% else %}
          <div class="avatar avatar-lg avatar-fallback">
            {{ (current_user.username[:1] if current_user.username else 'A')|upper }}
          </div>
        {% endif %}

        <div class="dash-identity-text">
          <div class="dash-kicker">Dashboard</div>
          <div class="dash-name-row">
            <h1 class="dash-name">{{ current_user.display_name|default(current_user.username, true) }}</h1>
            <span class="role-pill">ARTIST</span>
          </div>
          <div class="muted dash-handle">@{{ current_user.username }}</div>
        </div>
      </div>

      <div class="dash-actions">
        <a class="btn btn-primary" href="{{ url_for('wallet_home') }}">Wallet</a>
        <a class="btn btn-secondary" href="{{ url_for('market_index') }}">Market</a>
        <a class="btn btn-ghost" href="{{ url_for('bookme_search') }}">BookMe</a>
      </div>
    </div>

    <!-- STATS -->
    <div class="stats-grid">
      <div class="stat">
        <div class="stat-label">Followers</div>
        <div class="stat-value">{{ followers_count|default(0, true) }}</div>
        <div class="muted">People following you</div>
      </div>

      <div class="stat">
        <div class="stat-label">Following</div>
        <div class="stat-value">{{ following_count|default(0, true) }}</div>
        <div class="muted">People you follow</div>
      </div>

      <div class="stat">
        <div class="stat-label">Bookings</div>
        <div class="stat-value">{{ bookings_count|default(0, true) }}</div>
        <div class="muted">Total bookings</div>
      </div>

      <div class="stat">
        <div class="stat-label">Confirmed</div>
        <div class="stat-value">{{ confirmed_bookings|default(0, true) }}</div>
        <div class="muted">Confirmed bookings</div>
      </div>
    </div>
  </div>

  <!-- MAIN GRID -->
  <div class="dash-grid">

    <!-- LEFT -->
    <div class="dash-col">
      <div class="card">
        <div class="card-head">
          <h2 class="card-title">Quick Actions</h2>
        </div>

        <div class="action-grid">
          <a class="action-card" href="{{ url_for('wallet_home') }}">
            <div class="action-title">Open Wallet</div>
            <div class="muted">Deposit, withdraw, transactions</div>
          </a>

          <a class="action-card" href="{{ url_for('producer_catalog_index') }}">
            <div class="action-title">Producers</div>
            <div class="muted">Browse producer catalogs</div>
          </a>

          <a class="action-card" href="{{ url_for('bookme_search') }}">
            <div class="action-title">BookMe</div>
            <div class="muted">Find creators & request bookings</div>
          </a>

          <a class="action-card" href="{{ url_for('opportunities') }}">
            <div class="action-title">Opportunities</div>
            <div class="muted">Loans, scholarships, programs</div>
          </a>
        </div>
      </div>

      <div class="card">
        <div class="card-head">
          <h2 class="card-title">Recent Bookings</h2>
        </div>

        {% if recent_bookings and recent_bookings|length > 0 %}
          <div class="suggested-list">
            {% for b in recent_bookings %}
              <div class="suggested-row">
                <div class="suggested-left">
                  <div class="suggested-meta">
                    <div class="suggested-name">Booking #{{ b.id }}</div>
                    <div class="muted">
                      {{ b.status }} · {{ b.event_datetime }}
                    </div>
                  </div>
                </div>
                <div class="suggested-actions">
                  <span class="pill pill-neutral">{{ b.status }}</span>
                </div>
              </div>
            {% endfor %}
          </div>
        {% else %}
          <div class="muted">No recent bookings yet.</div>
        {% endif %}
      </div>
    </div>

    <!-- RIGHT -->
    <div class="dash-col">
      <div class="card">
        <div class="card-head">
          <h2 class="card-title">Booking Breakdown</h2>
        </div>

        <div class="suggested-list">
          <div class="suggested-row">
            <div class="suggested-left">
              <div class="suggested-meta">
                <div class="suggested-name">Pending</div>
                <div class="muted">Awaiting confirmation</div>
              </div>
            </div>
            <div class="suggested-actions">
              <span class="pill pill-neutral">{{ pending_bookings|default(0, true) }}</span>
            </div>
          </div>

          <div class="suggested-row">
            <div class="suggested-left">
              <div class="suggested-meta">
                <div class="suggested-name">Confirmed</div>
                <div class="muted">Approved bookings</div>
              </div>
            </div>
            <div class="suggested-actions">
              <span class="pill pill-neutral">{{ confirmed_bookings|default(0, true) }}</span>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-head">
          <h2 class="card-title">Next Step</h2>
        </div>
        <div class="muted">Add a profile picture + connect with creators to grow faster.</div>
      </div>
    </div>

  </div>
</div>
{% endblock %}
